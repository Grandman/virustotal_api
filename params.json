{"name":"Virustotal api","tagline":"Ruby Gem for VirusTotal API","body":"# VirustotalAPI\r\n\r\nRuby Gem for [VirusTotal](https://www.virustotal.com) [V2 API](https://www.virustotal.com/en/documentation/public-api/)\r\n\r\n[![Build Status](https://secure.travis-ci.org/pwelch/virustotal_api.svg)](http://travis-ci.org/pwelch/virustotal_api)\r\n\r\n## Installation\r\n\r\nAdd this line to your application's Gemfile:\r\n\r\n```ruby\r\ngem 'virustotal_api'\r\n```\r\n\r\nAnd then execute:\r\n\r\n    $ bundle\r\n\r\nOr install it yourself as:\r\n\r\n    $ gem install virustotal_api\r\n\r\n## Usage\r\n\r\n### File Report\r\n\r\n```ruby\r\nrequire 'virustotal_api'\r\n\r\nsha256  = '01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b'\r\napi_key = 'MY_API_KEY'\r\n\r\nvtreport = VirustotalAPI::FileReport.find(sha256, api_key)\r\n\r\n# Does the resource have any results?\r\nvtreport.exists?\r\n# => true\r\n\r\n# URL for File Report (if it exists)\r\nvtreport.report_url\r\n# => \"https://www.virustotal.com/file/01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b/analysis/1418032127/\"\r\n\r\n# Report results (if they exist) are available via #report\r\nvtreport.report[\"scans\"][\"ClamAV\"]\r\n# => {\"detected\"=>false, \"version\"=>\"0.98.5.0\", \"result\"=>nil, \"update\"=>\"20141208\"}\r\n```\r\n\r\n### File Scan\r\n\r\n```ruby\r\nrequire 'virustotal_api'\r\n\r\nfile    = '/path/to/file'\r\napi_key = 'MY_API_KEY'\r\n\r\nvtscan = VirustotalAPI::FileScan.scan(file, api_key)\r\n\r\n# Scan ID of file\r\nvtscan.scan_id\r\n# => \"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b-1419454668\"\r\n\r\n# Response results are available via #response\r\nvtreport.response\r\n# =>\r\n{\r\n  \"scan_id\"=>\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b-1419454668\",\r\n  \"sha1\"=>\"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc\",\r\n  \"resource\"=>\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\r\n  \"response_code\"=>1,\r\n  \"sha256\"=>\"01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b\",\r\n  \"permalink\"=>\"https://www.virustotal.com/file/01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b/analysis/1419454668/\",\r\n  \"md5\"=>\"68b329da9893e34099c7d8ad5cb9c940\",\r\n  \"verbose_msg\"=>\"Scan request successfully queued, come back later for the report\"\r\n}\r\n```\r\n\r\n### URL Report\r\n\r\n```ruby\r\nrequire 'virustotal_api'\r\n\r\nurl     = 'http://www.google.com'\r\napi_key = 'MY_API_KEY'\r\n\r\nvturl_report = VirustotalAPI::URLReport.find(url, api_key)\r\n\r\n# Does the resource have any results?\r\nvturl_report.exists?\r\n# => true\r\n\r\n# URL for Report (if it exists)\r\nvturl_report.report_url\r\n# => \"https://www.virustotal.com/url/dd014af5ed6b38d9130e3f466f850e46d21b951199d53a18ef29ee9341614eaf/analysis/1419457210/\"\r\n\r\n# Report results (if they exist) are available via #report\r\nvturl_report.report[\"scans\"][\"Opera\"]\r\n# => {\"detected\"=>false, \"result\"=>\"clean site\"}\r\n```\r\n\r\n### IP Report\r\n\r\n```ruby\r\nrequire 'virustotal_api'\r\n\r\nip      = '8.8.8.8'\r\napi_key = 'MY_API_KEY'\r\n\r\nvtip_report = VirustotalAPI::IPReport.find(ip, api_key)\r\n\r\n# Does the resource have any results?\r\nvtip_report.exists?\r\n# => true\r\n\r\n# Report results (if they exist) are available via #report\r\nvtip_report.report\r\n# => Hash of report results\r\n```\r\n\r\n### Domain Report\r\n\r\n```ruby\r\nrequire 'virustotal_api'\r\n\r\ndomain  = 'virustotal.com'\r\napi_key = 'MY_API_KEY'\r\n\r\nvtdomain_report = VirustotalAPI::DomainReport.find(domain, api_key)\r\n\r\n# Does the resource have any results?\r\nvtdomain_report.exists?\r\n# => true\r\n\r\n# Report results (if they exist) are available via #report\r\nvtdomain_report.report\r\n# => Hash of report results\r\n```\r\n\r\n## Contributing\r\n\r\n1. Fork it ( https://github.com/pwelch/virustotal_api/fork )\r\n2. Create your feature branch (`git checkout -b my-new-feature`)\r\n3. Commit your changes (`git commit -am 'Add some feature'`)\r\n4. Push to the branch (`git push origin my-new-feature`)\r\n5. Create a new Pull Request\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}